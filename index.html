<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/icons/icon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DreamBuild - Universal AI Development Platform</title>
    <meta name="description" content="The world's most advanced AI-powered development platform supporting 100+ programming languages across all platforms and frameworks." />
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.json?v=2.0.0" />
    <meta name="theme-color" content="#000000" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="DreamBuild" />
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="DreamBuild - Universal AI Development Platform" />
    <meta property="og:description" content="The world's most advanced AI-powered development platform supporting 100+ programming languages across all platforms and frameworks." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://dreambuild-2024-app.web.app" />
    <meta property="og:image" content="/icons/icon-512x512.png" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="DreamBuild - Universal AI Development Platform" />
    <meta name="twitter:description" content="The world's most advanced AI-powered development platform supporting 100+ programming languages across all platforms and frameworks." />
    <meta name="twitter:image" content="/icons/icon-512x512.png" />
    
    <!-- Preload critical resources -->
    <!-- <link rel="preload" href="/fonts/inter-var.woff2" as="font" type="font/woff2" crossorigin /> -->
    
    <!-- Critical CSS inline -->
    <style>
      /* Critical CSS for initial render */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        line-height: 1.6;
        color: #333;
        background: #f8fafc;
      }
      
      #root {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      
      /* Loading spinner */
      .loading {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #f8fafc;
      }
      
      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #e2e8f0;
        border-top: 4px solid #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
  </head>
  <body>
    <div id="root">
      <div class="loading">
        <div class="spinner"></div>
      </div>
    </div>
    
    <!-- Firebase SDK - Temporarily Disabled -->
    <script type="module">
      // Temporarily disable Firebase to test if it's causing the Request destructuring error
      console.log('Firebase temporarily disabled for testing');
      
      // Create mock Firebase objects
      window.firebase = { 
        auth: () => null,
        GoogleAuthProvider: null,
        GithubAuthProvider: null,
        signInWithPopup: null
      };
      window.firebaseApp = null;
      
      console.log('Mock Firebase loaded:', !!window.firebase);
    </script>
    
    <!-- Polyfills removed - using modern React 18.3.1 with native browser support -->
    
    <!-- Service Worker Registration -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('DreamBuild SW registered:', registration);
            })
            .catch(error => {
              console.log('DreamBuild SW registration failed:', error);
            });
        });
      }
    </script>
    
    <!-- Comprehensive polyfills for essential APIs -->
    <script>
      console.log('ðŸ”§ Loading comprehensive polyfills...');
      
      // Ensure global objects exist
      if (typeof globalThis === 'undefined') {
        window.globalThis = window;
      }
      
      // Essential polyfills for Request/Response APIs
      if (!window.Request) {
        window.Request = class Request {
          constructor(input, init = {}) {
            this.url = input;
            this.method = init.method || 'GET';
            this.headers = new Headers(init.headers || {});
            this.body = init.body;
          }
        };
      }
      
      // Ensure Request is available in all possible ways
      if (typeof globalThis !== 'undefined') {
        globalThis.Request = window.Request;
      }
      if (typeof global !== 'undefined') {
        global.Request = window.Request;
      }
      if (typeof self !== 'undefined') {
        self.Request = window.Request;
      }
      
      if (!window.Headers) {
        window.Headers = class Headers {
          constructor(init = {}) {
            this._headers = {};
            if (init) {
              Object.entries(init).forEach(([key, value]) => {
                this._headers[key.toLowerCase()] = value;
              });
            }
          }
          get(name) { return this._headers[name.toLowerCase()]; }
          set(name, value) { this._headers[name.toLowerCase()] = value; }
          has(name) { return name.toLowerCase() in this._headers; }
        };
      }
      
      if (!window.Response) {
        window.Response = class Response {
          constructor(body, init = {}) {
            this.body = body;
            this.status = init.status || 200;
            this.statusText = init.statusText || 'OK';
            this.headers = new Headers(init.headers || {});
            this.ok = this.status >= 200 && this.status < 300;
          }
          async json() { return JSON.parse(this.body); }
          async text() { return this.body; }
        };
      }
      
      if (!window.fetch) {
        window.fetch = async function(url, options = {}) {
          const xhr = new XMLHttpRequest();
          return new Promise((resolve, reject) => {
            xhr.open(options.method || 'GET', url);
            if (options.headers) {
              Object.entries(options.headers).forEach(([key, value]) => {
                xhr.setRequestHeader(key, value);
              });
            }
            xhr.onload = function() {
              resolve(new window.Response(xhr.responseText, {
                status: xhr.status,
                statusText: xhr.statusText,
                headers: xhr.getAllResponseHeaders()
              }));
            };
            xhr.onerror = function() { reject(new Error('Network error')); };
            xhr.send(options.body);
          });
        };
      }
      
      // Make sure Request, Headers, Response are available globally
      if (typeof globalThis !== 'undefined') {
        globalThis.Request = window.Request;
        globalThis.Headers = window.Headers;
        globalThis.Response = window.Response;
        globalThis.fetch = window.fetch;
      }
      
      // Also make them available on global object
      if (typeof global !== 'undefined') {
        global.Request = window.Request;
        global.Headers = window.Headers;
        global.Response = window.Response;
        global.fetch = window.fetch;
      }
      
      // Add a global object that might be expected by some libraries
      if (typeof window !== 'undefined') {
        window.global = window.global || window;
        window.globalThis = window.globalThis || window;
      }
      
      // Ensure all Web APIs are available in all contexts
      const webAPIs = { Request, Headers, Response, fetch };
      Object.entries(webAPIs).forEach(([name, api]) => {
        if (api) {
          // Make available in all possible global contexts
          if (typeof globalThis !== 'undefined') globalThis[name] = api;
          if (typeof global !== 'undefined') global[name] = api;
          if (typeof self !== 'undefined') self[name] = api;
          if (typeof window !== 'undefined') window[name] = api;
        }
      });
      
      console.log('âœ… Comprehensive polyfills loaded:', {
        Request: !!window.Request,
        Headers: !!window.Headers,
        Response: !!window.Response,
        fetch: !!window.fetch,
        globalThis: typeof globalThis !== 'undefined',
        global: typeof global !== 'undefined',
        self: typeof self !== 'undefined'
      });
    </script>
    
    <script type="module" src="/src/main.jsx?v=2024-01-27-fresh"></script>
  </body>
</html>