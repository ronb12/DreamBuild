import{j as e}from"./index-B591Yj5A.js";import{r,a as S,a6 as P,G as q,al as W,E as b,m as _,aD as h,a3 as C,x as F,aw as H}from"./ui-vendor-ChI1OeIp.js";import{g as O,z as i,f}from"./App-B4KCy3AR.js";import{t as Y,n as J,w as K,x as Q,y as X}from"./firebase-CWduLZnq.js";import"./monaco-editor-4pq07gti.js";import"./react-vendor-D3F3s8fL.js";const ie=()=>{const[g,p]=r.useState([]),[c,E]=r.useState([]),[R,j]=r.useState(!0),[l,w]=r.useState(""),[d,B]=r.useState("grid"),[u,T]=r.useState("newest"),[x,N]=r.useState(null),[v,y]=r.useState(!1);r.useEffect(()=>{m(),M();let s=null;try{s=z()}catch(a){console.error("âŒ Failed to setup real-time listener:",a)}const t=a=>{console.log("ðŸ“¡ App deployment event received:",a.detail),i.success(`New app "${a.detail.appName}" added to gallery!`,{duration:4e3,icon:"ðŸš€"}),m(!0)};return window.addEventListener("appDeployed",t),()=>{s&&s(),window.removeEventListener("appDeployed",t)}},[]);const z=()=>{try{console.log("ðŸ”„ Setting up real-time listener for apps...");const s=Y(J(O,"apps"),K("isPublic","==",!0),Q("createdAt","desc"));return X(s,a=>{console.log("ðŸ“¡ Real-time update received:",a.docs.length,"apps");const n=a.docs.map(o=>({id:o.id,...o.data()}));if(p(n),n.length>0){const o=n[0],$=new Date,G=o.createdAt?.toDate?.()||new Date(o.createdAt);$-G<3e4&&i.success(`New app "${o.name}" added to gallery!`,{duration:4e3,icon:"ðŸš€"})}},a=>{console.error("âŒ Real-time listener error:",a),console.log("ðŸ”„ Falling back to manual refresh due to permissions error"),i.error("Real-time updates disabled - use refresh button",{duration:3e3})})}catch(s){return console.error("âŒ Error setting up real-time listener:",s),console.log("ðŸ”„ Real-time listener setup failed, using manual refresh only"),null}};r.useEffect(()=>{V()},[g,l,u]);const m=async(s=!1)=>{try{s?y(!0):j(!0),console.log("ðŸ”„ Loading apps from Firebase...");const t=await f.getPublicApps(50);if(console.log("âœ… Loaded apps:",t.length),console.log("âœ… Apps data:",t),p(t),t.length===0){console.log("âš ï¸ No public apps found in Firebase");const a=document.createElement("div");a.className="fixed top-20 left-4 bg-yellow-500 text-white px-4 py-2 rounded shadow-lg z-10",a.textContent="No apps found in Firebase",a.id="no-apps-debug",document.body.appendChild(a),setTimeout(()=>{const n=document.getElementById("no-apps-debug");n&&n.remove()},5e3)}}catch(t){console.error("âŒ Error loading apps:",t),i.error("Failed to load apps"),p([])}finally{j(!1),y(!1)}},M=async()=>{try{console.log("ðŸ”„ Loading app stats from Firebase...");const s=await f.getAppStats();console.log("âœ… Loaded stats:",s),N(s)}catch(s){console.error("âŒ Error loading stats:",s),N({totalApps:0,publicApps:0,totalViews:0,totalLikes:0})}},V=()=>{let s=[...g];switch(l&&(s=s.filter(t=>t.name.toLowerCase().includes(l.toLowerCase())||t.tags.some(a=>a.toLowerCase().includes(l.toLowerCase())))),u){case"newest":s.sort((t,a)=>new Date(a.createdAt)-new Date(t.createdAt));break;case"popular":s.sort((t,a)=>(a.views||0)-(t.views||0));break;case"trending":s.sort((t,a)=>(a.likes||0)-(t.likes||0));break}E(s)},I=s=>{w(s.target.value)},U=s=>{T(s.target.value)},k=s=>{B(s)},A=s=>{navigator.share?navigator.share({title:s.name,url:s.url}):(navigator.clipboard.writeText(s.url),i.success("URL copied to clipboard!"))},L=async s=>{try{await f.toggleLike(s.id,"anonymous"),i.success("Liked!"),m()}catch{i.error("Failed to like app")}},D=s=>{if(!s)return"Unknown date";try{let t;return s&&typeof s=="object"&&s.toDate?t=s.toDate():s&&typeof s=="object"&&s.seconds?t=new Date(s.seconds*1e3):t=new Date(s),isNaN(t.getTime())?"Unknown date":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(t){return console.error("Date formatting error:",t),"Unknown date"}};return R?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Loading DreamBuild Apps..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[e.jsx("div",{className:"bg-white shadow-sm border-b mt-16",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"DreamBuild App Gallery"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Discover amazing apps created with DreamBuild AI"}),e.jsx("button",{onClick:()=>m(!0),disabled:v,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 flex items-center gap-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-4 w-4 animate-spin"}),"Refreshing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-4 w-4"}),"Refresh Apps"]})})]})})}),x&&e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:x.publicApps}),e.jsx("div",{className:"text-sm text-gray-500",children:"Public Apps"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:x.totalViews}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Views"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:x.totalLikes}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Likes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:c.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Filtered Results"})]})]})})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-center lg:justify-between",children:[e.jsxs("div",{className:"relative w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search amazing apps...",value:l,onChange:I,className:"w-full pl-4 pr-12 py-3 bg-white border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 focus:outline-none transition-all duration-200 shadow-sm hover:shadow-md focus:shadow-lg"}),e.jsx(P,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),l&&e.jsx("button",{onClick:()=>w(""),className:"absolute right-10 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:e.jsxs("div",{className:"p-3 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:c.length})," app",c.length!==1?"s":"",' found for "',e.jsx("span",{className:"font-medium text-blue-600",children:l}),'"']})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:u,onChange:U,className:"appearance-none px-4 py-3 pr-8 bg-white border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:border-blue-500 focus:outline-none transition-all duration-200 shadow-sm hover:shadow-md focus:shadow-lg cursor-pointer",children:[e.jsx("option",{value:"newest",children:"ðŸ†• Newest"}),e.jsx("option",{value:"popular",children:"ðŸ”¥ Most Popular"}),e.jsx("option",{value:"trending",children:"ðŸ“ˆ Trending"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>k("grid"),className:`p-2 rounded-lg transition-all duration-200 ${d==="grid"?"bg-blue-500 text-white shadow-md":"text-gray-600 hover:bg-white hover:shadow-sm"}`,children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>k("list"),className:`p-2 rounded-lg transition-all duration-200 ${d==="list"?"bg-blue-500 text-white shadow-md":"text-gray-600 hover:bg-white hover:shadow-sm"}`,children:e.jsx(W,{className:"h-4 w-4"})})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.length===0?e.jsx("div",{className:"text-center py-12",children:g.length===0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸš€"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No apps yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Be the first to create an amazing app with DreamBuild AI!"}),e.jsxs("a",{href:"/ai-builder",className:"inline-flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("span",{children:"Create Your First App"}),e.jsx(b,{className:"h-4 w-4"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No apps found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filters"})]})}):e.jsx("div",{className:d==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:c.map(s=>e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow ${d==="list"?"flex":""}`,children:d==="grid"?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>L(s),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(h,{className:"h-4 w-4 text-gray-400"})}),e.jsx("button",{onClick:()=>A(s),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(C,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-full h-32 bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"ðŸš€"}),e.jsx("div",{className:"text-sm text-gray-600",children:"DreamBuild App"})]})})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:s.views||0})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx("span",{children:s.likes||0})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:D(s.createdAt)})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:s.tags.slice(0,3).map((t,a)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:t},a))}),e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"View App"]})]}):e.jsx("div",{className:"p-6 flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:["Created ",D(s.createdAt)]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.views||0," views"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.likes||0," likes"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>L(s),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(h,{className:"h-4 w-4 text-gray-400"})}),e.jsx("button",{onClick:()=>A(s),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(C,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"View"]})]})]})})},s.id))})})]})};export{ie as default};
